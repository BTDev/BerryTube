<h2 id="title">Copying settings to new system...</h2>
<p id="desc">If you are stuck on this page, you are probably blocking scripts and/or cookies from BerryTube.</p>
<script>
const origin = 'https://' + location.hostname.replace(/^www\./, '');
window.onmessage = function(event){
    if (event.data === 'done') {
        document.getElementById('title').textContent = 'Redirecting to new system...';
        document.getElementById('desc').textContent = '';
        location.href = origin + location.hash.replace(/^#/, '');
    }
};
const frame = document.createElement('iframe');
frame.onload = function(){
    const data = {};
    for (const key of Object.keys(localStorage)) {
        if (localStorage.hasOwnProperty(key))
            data[key] = localStorage[key];
    }
    frame.contentWindow.postMessage(data, origin);
};
frame.src = origin + '/api/migrate_frame.html';
document.head.appendChild(frame);
</script>
